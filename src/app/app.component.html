// import { Component } from '@angular/core';
// import {
//   CdkDragDrop,
//   moveItemInArray,
//   transferArrayItem,
// } from '@angular/cdk/drag-drop';
// import { CommonModule } from '@angular/common';
// import { FormsModule } from '@angular/forms';
// import { MatInputModule } from '@angular/material/input';
// import { MatCheckboxModule } from '@angular/material/checkbox';
// import { MatSelectModule } from '@angular/material/select';
// import { MatFormFieldModule } from '@angular/material/form-field';
// import { MatRadioModule } from '@angular/material/radio';
// import { DragDropModule } from '@angular/cdk/drag-drop';

// interface FormField {
//   type:
//     | 'text'
//     | 'checkbox'
//     | 'select'
//     | 'textarea'
//     | 'date'
//     | 'number'
//     | 'radio'
//     | 'input'
//     | 'spacer';
//   label: string;
//   placeholder?: string;
//   fontSize?: string;
//   options?: string[];
//   appearance?: 'fill' | 'outline' | 'standard' | 'legacy';
//   colSpan: number;
//   [key: string]: any;
// }

// interface Row {
//   fields: FormField[];
// }

// @Component({
//   selector: 'app-root',
//   standalone: true,
//   imports: [
//     CommonModule,
//     FormsModule,
//     MatInputModule,
//     MatCheckboxModule,
//     MatSelectModule,
//     MatFormFieldModule,
//     MatRadioModule,
//     DragDropModule,
//   ],
//   template: `
//     <div class="container">
//       <div
//         class="panel left"
//         cdkDropList
//         id="availableFields"
//         [cdkDropListData]="availableFields"
//         [cdkDropListConnectedTo]="rowDropListIds"
//         [cdkDropListEnterPredicate]="preventDropToAvailable"
//       >
//         <h3>Available Fields</h3>
//         <div *ngFor="let field of availableFields" cdkDrag class="field-item">
//           {{ field.label }}
//         </div>
//       </div>

//       <div class="panel center" cdkDropList id="formBuilder" [cdkDropListConnectedTo]="['availableFields']" (cdkDropListDropped)="dropIntoForm($event)">
//         <h3>Form Builder</h3>
//         <div *ngFor="let row of formFields; let rowIndex = index" class="row" cdkDropList [id]="'row-' + rowIndex" [cdkDropListData]="row.fields" [cdkDropListConnectedTo]="allDropListIds" (cdkDropListDropped)="dropField($event, rowIndex)">
//           <div *ngIf="row.fields.length === 0" class="empty-row">Drag fields here</div>
//           <div *ngFor="let field of row.fields; let fieldIndex = index" cdkDrag  (click)="selectField(rowIndex, fieldIndex)" class="form-preview" [class.selected]="selectedField?.rowIndex === rowIndex && selectedField?.fieldIndex === fieldIndex">
//             <mat-form-field *ngIf="field.type === 'input'" [appearance]="field.appearance" [style.fontSize]="field.fontSize">
//               <mat-label>{{ field.label }}</mat-label>
//               <input matInput [placeholder]="field.placeholder" />
//             </mat-form-field>
//             <mat-form-field *ngIf="field.type === 'textarea'" [appearance]="field.appearance" [style.fontSize]="field.fontSize">
//               <mat-label>{{ field.label }}</mat-label>
//               <textarea matInput [placeholder]="field.placeholder"></textarea>
//             </mat-form-field>
//             <mat-form-field *ngIf="field.type === 'number'" [appearance]="field.appearance" [style.fontSize]="field.fontSize">
//               <mat-label>{{ field.label }}</mat-label>
//               <input matInput type="number" [placeholder]="field.placeholder" />
//             </mat-form-field>
//             <mat-form-field *ngIf="field.type === 'date'" [appearance]="field.appearance" [style.fontSize]="field.fontSize">
//               <mat-label>{{ field.label }}</mat-label>
//               <input matInput type="date" />
//             </mat-form-field>
//             <mat-checkbox *ngIf="field.type === 'checkbox'" [style.fontSize]="field.fontSize">
//               {{ field.label }}
//             </mat-checkbox>
//             <mat-radio-group *ngIf="field.type === 'radio'" [style.fontSize]="field.fontSize">
//               <label>{{ field.label }}</label><br />
//               <mat-radio-button *ngFor="let opt of field.options">{{ opt }}</mat-radio-button>
//             </mat-radio-group>
//             <mat-form-field *ngIf="field.type === 'select'" [appearance]="field.appearance" [style.fontSize]="field.fontSize">
//               <mat-label>{{ field.label }}</mat-label>
//               <mat-select>
//                 <mat-option *ngFor="let opt of field.options" [value]="opt">{{ opt }}</mat-option>
//               </mat-select>
//             </mat-form-field>
//             <p *ngIf="field.type === 'text'" [style.fontSize]="field.fontSize">{{ field.label }}</p>
//             <div *ngIf="field.type === 'spacer'" class="spacer"></div>
//             <div *ngIf="selectedField?.rowIndex === rowIndex && selectedField?.fieldIndex === fieldIndex" class="delete-button" (click)="deleteField($event)">X</div>
//           </div>
//         </div>
//         <!-- <button (click)="addRow()">Add Row</button> -->
//       </div>

//       <div class="panel right">
//         <h3>Content</h3>
//         <div *ngIf="!selectedField">
//           <h4>Global Settings</h4>
//           <label>Global Font Size</label>
//           <input [(ngModel)]="globalFontSize" (change)="applyGlobalFontSize()" />
//         </div>
//         <h3>Styling</h3>
//         <div>
          
//         </div>
//         <div *ngIf="selectedField">
//           <div *ngIf="formFields[selectedField.rowIndex].fields[selectedField.fieldIndex].type !== 'spacer'">
//             <label>Font Size</label>
//             <input [(ngModel)]="formFields[selectedField.rowIndex].fields[selectedField.fieldIndex].fontSize" />
//             <label>Label</label>
//             <input [(ngModel)]="formFields[selectedField.rowIndex].fields[selectedField.fieldIndex].label" />
//             <label *ngIf="formFields[selectedField.rowIndex].fields[selectedField.fieldIndex].placeholder">Placeholder</label>
//             <input *ngIf="formFields[selectedField.rowIndex].fields[selectedField.fieldIndex].placeholder" [(ngModel)]="formFields[selectedField.rowIndex].fields[selectedField.fieldIndex].placeholder" />
//             <label *ngIf="formFields[selectedField.rowIndex].fields[selectedField.fieldIndex].appearance">Appearance</label>
//             <select *ngIf="formFields[selectedField.rowIndex].fields[selectedField.fieldIndex].appearance" [(ngModel)]="formFields[selectedField.rowIndex].fields[selectedField.fieldIndex].appearance">
//               <option value="fill">Fill</option>
//               <option value="outline">Outline</option>
//               <option value="standard">Standard</option>
//               <option value="legacy">Legacy</option>
//             </select>
//             <div *ngIf="formFields[selectedField.rowIndex].fields[selectedField.fieldIndex].options">
//               <label>Options</label>
//               <div *ngFor="let opt of formFields[selectedField.rowIndex].fields[selectedField.fieldIndex].options; let j = index">
//                 <input [(ngModel)]="formFields[selectedField.rowIndex].fields[selectedField.fieldIndex].options[j]" />
//               </div>
//               <button (click)="addOption()">Add Option</button>
//             </div>
//           </div>
//           <label>Col Span</label>
//           <input type="number" [(ngModel)]="formFields[selectedField.rowIndex].fields[selectedField.fieldIndex].colSpan" min="1" max="12" (change)="validateColSpan(selectedField.rowIndex)" />
//         </div>
//       </div>
//     </div>
//   `,
//   styles: [
//     `
//       .container {
//         display: flex;
//         flex-direction: row;
//         gap: 24px;
//         padding: 24px;
//         background: #eef2f5;
//       }
//       .panel {
//         flex: 1;
//         border: 1px solid #d0d7de;
//         border-radius: 12px;
//         padding: 20px;
//         min-height: 500px;
//         background: #ffffff;
//         box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
//         overflow-y: auto;
//       }
//       .left, .right {
//         max-width: 200px;
//       }
//       .panel h3 {
//         margin-top: 0;
//         font-weight: 600;
//         color: #2c3e50;
//       }
//       .field-item {
//         padding: 10px;
//         border: 1px dashed #bbb;
//         margin-bottom: 10px;
//         background: #fdfdfd;
//         cursor: grab;
//         border-radius: 6px;
//         transition: all 0.2s;
//       }
//       .field-item:hover {
//         background-color: #f0f4f8;
//       }
//       .row {
//         display: flex;
//         width: 100%;
//         margin-bottom: 10px;
//       }
//       .form-preview {
//         position: relative;
//         width: 100%;
//       }
//       .empty-row {
//         padding: 20px;
//         text-align: center;
//         color: #666;
//         border: 1px dashed #ccc;
//         width: 100%;
//       }
//       .spacer {
//         min-height: 20px;
//       }
//       .delete-button {
//         position: absolute;
//         top: 5px;
//         right: 5px;
//         cursor: pointer;
//         color: red;
//         font-weight: bold;
//         width: fit-content !important;
//       }
//       .right input,
//       .right select {
//         width: 100%;
//         margin-bottom: 10px;
//         padding: 6px;
//         border-radius: 4px;
//         border: 1px solid #ccc;
//       }
//       .right button {
//         margin-top: 10px;
//         background-color: #007bff;
//         color: white;
//         border: none;
//         padding: 8px 12px;
//         border-radius: 4px;
//         cursor: pointer;
//       }
//       .right button:hover {
//         background-color: #0056b3;
//       }
//       .form-preview {
//         position: relative;
//         margin-right: 10px;
//       }
//       .form-preview > * {
//         display: flex;
//         align-items: center;
//         width: 100%;
//       }
//       .selected {
//                 border-radius: 8px;
//         border: 2px dotted #007bff;
//       }
//     `,
//   ],
// })
// export class AppComponent {
//   availableFields: FormField[] = [
//     { type: 'text', label: 'Static Text', fontSize: '16px', appearance: 'outline', colSpan: 1 },
//     { type: 'input', label: 'Input Field', placeholder: 'Enter text', fontSize: '16px', appearance: 'outline', colSpan: 1 },
//     { type: 'textarea', label: 'Text Area', placeholder: 'Enter more...', fontSize: '16px', appearance: 'outline', colSpan: 1 },
//     { type: 'number', label: 'Number Field', placeholder: '0', fontSize: '16px', appearance: 'outline', colSpan: 1 },
//     { type: 'date', label: 'Date Picker', fontSize: '16px', appearance: 'outline', colSpan: 1 },
//     { type: 'checkbox', label: 'Check Option', fontSize: '16px', colSpan: 1 },
//     { type: 'select', label: 'Select Option', options: ['Option 1', 'Option 2'], fontSize: '16px', appearance: 'outline', colSpan: 1 },
//     { type: 'radio', label: 'Choose One', options: ['Yes', 'No'], fontSize: '16px', colSpan: 1 },
//     { type: 'spacer', label: 'Spacer', colSpan: 1 },
//   ];

//   formFields: Row[] = [
//     { fields: [{ type: 'text', label: 'Revising Drag and Drop', colSpan: 12 }] },
//   ];

//   selectedField: { rowIndex: number; fieldIndex: number } | null = null;
//   globalFontSize: string = '16px';

//   get rowDropListIds(): string[] {
//     return this.formFields.map((_, i) => 'row-' + i);
//   }

//   get allDropListIds(): string[] {
//     return ['availableFields', ...this.rowDropListIds];
//   }

//   ngOnInit() {
//     this.addRow();
//   }

//   preventDropToAvailable(): boolean {
//     return false;
//   }

//   dropIntoForm(event: CdkDragDrop<any>) {
//     if (event.previousContainer.id === 'availableFields') {
//       const newField = { ...JSON.parse(JSON.stringify(event.previousContainer.data[event.previousIndex])), colSpan: 12 };
//       const newRow: Row = { fields: [newField] };
//       this.formFields.push(newRow);
//     }
//   }

//   dropField(event: CdkDragDrop<FormField[]>, rowIndex: number) {
//     const row = this.formFields[rowIndex];
//     if (event.previousContainer === event.container) {
//       moveItemInArray(row.fields, event.previousIndex, event.currentIndex);
//       this.adjustColSpans(row);
//     } else if (event.previousContainer.id === 'availableFields') {
//       const newField = { ...JSON.parse(JSON.stringify(event.previousContainer.data[event.previousIndex])), colSpan: 1, fontSize: this.globalFontSize };
//       if (row.fields.length >= 12) {
//         alert('Cannot add field: row would exceed 12 columns');
//       } else {
//         row.fields.splice(event.currentIndex, 0, newField);
//         this.adjustColSpans(row);
//       } 
//     } else {
//       const previousRowIndex = parseInt(event.previousContainer.id.split('-')[1]);
//       const previousRow = this.formFields[previousRowIndex];
//       const field = previousRow.fields[event.previousIndex];
//       if (row.fields.length >= 12) {
//         alert('Cannot transfer field: row would exceed 12 columns');
//       } else {
//         transferArrayItem(
//           previousRow.fields,
//           row.fields,
//           event.previousIndex,
//           event.currentIndex
//         );
//         this.adjustColSpans(row);
//         this.adjustColSpans(previousRow);
//       }
//     }

//     if (this.formFields.every((row) => row.fields.length)) this.addRow();
//   }

//   selectField(rowIndex: number, fieldIndex: number) {
//     this.selectedField = { rowIndex, fieldIndex };
//   }

//   addRow() {
//     this.formFields.push({ fields: [] });
//   }

//   deleteField(event?: Event) {
//     if (event) {
//       event.stopPropagation();
//     }
//     if (this.selectedField) {
//       const { rowIndex, fieldIndex } = this.selectedField;
//       const row = this.formFields[rowIndex];
//       row.fields.splice(fieldIndex, 1);
//       if (row.fields.length === 0) {
//         this.formFields.splice(rowIndex, 1);
//       } else {
//         this.adjustColSpans(row);
//       }
//       this.selectedField = null;
//     }
//   }

//   getTotalColSpan(row: Row): number {
//     return row.fields.reduce((sum, field) => sum + (field.colSpan || 1), 0);
//   }

//   validateColSpan(rowIndex: number) {
//     const row = this.formFields[rowIndex];
//     const total = this.getTotalColSpan(row);
//     if (total > 12) {
//       alert('Total column span exceeds 12. Adjusting...');
//       this.adjustColSpans(row);
//     }
//   }

//   adjustColSpans(row: Row) {
//     const totalFields = row.fields.length;
//     if (totalFields === 0) return;
//     const colSpan = Math.floor(12 / totalFields);
//     const remainder = 12 % totalFields;
//     row.fields.forEach((field, index) => {
//       field.colSpan = colSpan + (index < remainder ? 1 : 0);
//     });
//   }

//   applyGlobalFontSize() {
//     this.formFields.forEach(row => {
//       row.fields.forEach(field => {
//         field.fontSize = this.globalFontSize;
//       });
//     });
//   }

//   addOption() {
//     if (this.selectedField) {
//       const field = this.formFields[this.selectedField.rowIndex].fields[this.selectedField.fieldIndex];
//       if (!field.options) {
//         field.options = [];
//       }
//       field.options.push('New Option');
//     }
//   }
// }
